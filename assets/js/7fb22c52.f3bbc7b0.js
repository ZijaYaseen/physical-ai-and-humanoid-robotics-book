"use strict";(globalThis.webpackChunkphysical_ai_and_humanoid_robotics=globalThis.webpackChunkphysical_ai_and_humanoid_robotics||[]).push([[368],{67(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"auth-setup","title":"Authentication Setup Guide","description":"This document explains how to set up and configure the Better Auth integration in the Physical AI & Humanoid Robotics platform.","source":"@site/docs/auth-setup.md","sourceDirName":".","slug":"/auth-setup","permalink":"/physical-ai-and-humanoid-robotics-book/docs/auth-setup","draft":false,"unlisted":false,"editUrl":"https://github.com/ZijaYaseen/physical-ai-and-humanoid-robotics-book/tree/main/docs/auth-setup.md","tags":[],"version":"current","frontMatter":{}}');var s=i(4848),o=i(8453);const r={},l="Authentication Setup Guide",a={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installation",id:"installation",level:2},{value:"Database Setup",id:"database-setup",level:2},{value:"User Profiles Table",id:"user-profiles-table",level:3},{value:"Personalization Context Table",id:"personalization-context-table",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Backend Configuration",id:"backend-configuration",level:3},{value:"Frontend Integration",id:"frontend-integration",level:3},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"Authentication Endpoints",id:"authentication-endpoints",level:3},{value:"Profile Management Endpoints",id:"profile-management-endpoints",level:3},{value:"Personalization Endpoints",id:"personalization-endpoints",level:3},{value:"RAG Integration Endpoints",id:"rag-integration-endpoints",level:3},{value:"OAuth Provider Setup",id:"oauth-provider-setup",level:2},{value:"Google OAuth",id:"google-oauth",level:3},{value:"GitHub OAuth",id:"github-oauth",level:3},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Maintenance",id:"maintenance",level:2},{value:"Data Retention Policy",id:"data-retention-policy",level:3},{value:"GDPR Compliance",id:"gdpr-compliance",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"authentication-setup-guide",children:"Authentication Setup Guide"})}),"\n",(0,s.jsx)(n.p,{children:"This document explains how to set up and configure the Better Auth integration in the Physical AI & Humanoid Robotics platform."}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Node.js 18+ installed"}),"\n",(0,s.jsx)(n.li,{children:"Access to a Neon PostgreSQL database"}),"\n",(0,s.jsx)(n.li,{children:"OAuth credentials for Google and/or GitHub"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Install the required dependencies:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install better-auth @neondatabase/serverless drizzle-orm drizzle-kit pg\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["Set up your environment variables in ",(0,s.jsx)(n.code,{children:".env"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"# Better Auth Configuration\nBETTER_AUTH_SECRET=your-secret-key-here\nBETTER_AUTH_URL=http://localhost:3000\n\n# Neon Database Configuration\nNEON_DATABASE_URL=your-neon-database-url-here\n\n# OAuth Provider Configuration - Google\nGOOGLE_CLIENT_ID=your-google-client-id\nGOOGLE_CLIENT_SECRET=your-google-client-secret\n\n# OAuth Provider Configuration - GitHub\nGITHUB_CLIENT_ID=your-github-client-id\nGITHUB_CLIENT_SECRET=your-github-client-secret\n\n# Session Configuration\nSESSION_EXPIRES_IN_DAYS=30\n"})}),"\n",(0,s.jsx)(n.h2,{id:"database-setup",children:"Database Setup"}),"\n",(0,s.jsx)(n.p,{children:"The authentication system uses the following database tables:"}),"\n",(0,s.jsx)(n.h3,{id:"user-profiles-table",children:"User Profiles Table"}),"\n",(0,s.jsx)(n.p,{children:"Extends Better Auth's built-in user table:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE user_profiles (\n  user_id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,\n  programming_experience VARCHAR(20) CHECK (programming_experience IN ('beginner', 'intermediate', 'advanced')),\n  os_preference VARCHAR(20) CHECK (os_preference IN ('windows', 'macos', 'linux', 'other')),\n  development_tools TEXT[], -- Array of tool names\n  device_type VARCHAR(20) CHECK (device_type IN ('desktop', 'laptop', 'tablet', 'other')),\n  personalization_enabled BOOLEAN DEFAULT TRUE,\n  consent_given BOOLEAN DEFAULT FALSE,\n  consent_timestamp TIMESTAMP WITH TIME ZONE,\n  profile_updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  data_retention_expires TIMESTAMP WITH TIME ZONE\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"personalization-context-table",children:"Personalization Context Table"}),"\n",(0,s.jsx)(n.p,{children:"Tracks personalization context:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE user_personalization_context (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  user_id UUID REFERENCES user_profiles(user_id) ON DELETE CASCADE,\n  last_course_module_visited VARCHAR(100),\n  preferred_content_format VARCHAR(20) DEFAULT 'text',\n  difficulty_override VARCHAR(20), -- Temporary override for specific content\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"backend-configuration",children:"Backend Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The authentication is configured in ",(0,s.jsx)(n.code,{children:"backend/src/lib/auth.ts"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'import { betterAuth } from "better-auth";\nimport { drizzleAdapter } from "better-auth/adapters/drizzle";\nimport { db } from "./db";\n\nexport const auth = betterAuth({\n  database: drizzleAdapter(db, {\n    provider: "postgresql",\n  }),\n  secret: process.env.BETTER_AUTH_SECRET || "fallback-secret-for-development",\n  baseURL: process.env.BETTER_AUTH_URL || "http://localhost:3000",\n  emailAndPassword: {\n    enabled: true,\n    requireEmailVerification: false, // Set to true in production\n  },\n  socialProviders: {\n    google: {\n      clientId: process.env.GOOGLE_CLIENT_ID || "",\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET || "",\n    },\n    github: {\n      clientId: process.env.GITHUB_CLIENT_ID || "",\n      clientSecret: process.env.GITHUB_CLIENT_SECRET || "",\n    },\n  },\n  session: {\n    expiresIn: parseInt(process.env.SESSION_EXPIRES_IN_DAYS || "30") * 24 * 60 * 60, // Convert days to seconds\n  },\n});\n'})}),"\n",(0,s.jsx)(n.h3,{id:"frontend-integration",children:"Frontend Integration"}),"\n",(0,s.jsx)(n.p,{children:"The frontend uses an authentication context:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// frontend/src/contexts/AuthContext.tsx\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // Check auth status on initial load\n  useEffect(() => {\n    checkAuthStatus();\n  }, []);\n\n  // ... authentication methods\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,s.jsx)(n.h3,{id:"authentication-endpoints",children:"Authentication Endpoints"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POST /api/auth/signup"})," - User registration with email/OAuth"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POST /api/auth/signin"})," - User login with email/OAuth"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POST /api/auth/signout"})," - User logout"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"GET /api/auth/me"})," - Get current user profile"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POST /api/auth/forgot-password"})," - Password reset request"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POST /api/auth/reset-password"})," - Password reset confirmation"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"profile-management-endpoints",children:"Profile Management Endpoints"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"GET /api/profile"})," - Get user profile"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"PUT /api/profile"})," - Update user profile"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"DELETE /api/profile"})," - Delete user profile and associated data"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POST /api/profile/export"})," - Export user data for GDPR compliance"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"PUT /api/profile/preferences"})," - Update personalization preferences"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"personalization-endpoints",children:"Personalization Endpoints"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"GET /api/personalization/context"})," - Get current personalization context"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"PUT /api/personalization/context"})," - Update personalization context"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POST /api/personalization/opt-out"})," - Temporarily disable personalization"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POST /api/personalization/opt-in"})," - Re-enable personalization"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"rag-integration-endpoints",children:"RAG Integration Endpoints"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POST /api/query"})," - Enhanced query endpoint that includes user context"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POST /api/chatkit/session"})," - Session endpoint with user profile context"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"oauth-provider-setup",children:"OAuth Provider Setup"}),"\n",(0,s.jsx)(n.h3,{id:"google-oauth",children:"Google OAuth"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Go to the ",(0,s.jsx)(n.a,{href:"https://console.cloud.google.com/",children:"Google Cloud Console"})]}),"\n",(0,s.jsx)(n.li,{children:"Create a new project or select an existing one"}),"\n",(0,s.jsx)(n.li,{children:"Enable the Google+ API"}),"\n",(0,s.jsx)(n.li,{children:"Go to Credentials > Create Credentials > OAuth 2.0 Client IDs"}),"\n",(0,s.jsx)(n.li,{children:"Set authorized redirect URIs to your domain"}),"\n",(0,s.jsxs)(n.li,{children:["Add the credentials to your ",(0,s.jsx)(n.code,{children:".env"})," file"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"github-oauth",children:"GitHub OAuth"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Go to GitHub Settings > Developer settings > OAuth Apps"}),"\n",(0,s.jsx)(n.li,{children:'Click "New OAuth App"'}),"\n",(0,s.jsx)(n.li,{children:"Fill in the application details"}),"\n",(0,s.jsx)(n.li,{children:"Set the callback URL to your domain"}),"\n",(0,s.jsxs)(n.li,{children:["Add the credentials to your ",(0,s.jsx)(n.code,{children:".env"})," file"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Store ",(0,s.jsx)(n.code,{children:"BETTER_AUTH_SECRET"})," securely and rotate regularly"]}),"\n",(0,s.jsx)(n.li,{children:"Use HTTPS in production for secure transmission"}),"\n",(0,s.jsx)(n.li,{children:"Implement rate limiting for authentication endpoints"}),"\n",(0,s.jsx)(n.li,{children:"Validate OAuth callback URLs to prevent open redirect vulnerabilities"}),"\n",(0,s.jsx)(n.li,{children:"Sanitize user inputs to prevent injection attacks"}),"\n",(0,s.jsx)(n.li,{children:"Regularly audit authentication logs"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Issue"}),": OAuth callbacks not working\n",(0,s.jsx)(n.strong,{children:"Solution"}),": Verify that the redirect URIs in your OAuth provider settings match your application's domain"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Issue"}),": Database connection errors\n",(0,s.jsx)(n.strong,{children:"Solution"}),": Check that your ",(0,s.jsx)(n.code,{children:"NEON_DATABASE_URL"})," is correctly formatted and accessible"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Issue"}),": Session not persisting\n",(0,s.jsx)(n.strong,{children:"Solution"}),": Ensure your frontend and backend domains match for proper cookie handling"]}),"\n",(0,s.jsx)(n.h2,{id:"maintenance",children:"Maintenance"}),"\n",(0,s.jsx)(n.h3,{id:"data-retention-policy",children:"Data Retention Policy"}),"\n",(0,s.jsx)(n.p,{children:"The system implements automatic data retention policy enforcement:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"async enforceDataRetentionPolicy(): Promise<number> {\n  const client = await this.pool.connect();\n\n  try {\n    // Delete profiles where retention period has expired\n    const query = `\n      DELETE FROM user_profiles\n      WHERE data_retention_expires IS NOT NULL\n      AND data_retention_expires < NOW()\n    `;\n\n    const result = await client.query(query);\n    return result.rowCount || 0;\n  } finally {\n    client.release();\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"gdpr-compliance",children:"GDPR Compliance"}),"\n",(0,s.jsx)(n.p,{children:"The system includes features for GDPR compliance:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Data export functionality"}),"\n",(0,s.jsx)(n.li,{children:"Account deletion capability"}),"\n",(0,s.jsx)(n.li,{children:"Consent management"}),"\n",(0,s.jsx)(n.li,{children:"Data retention policies"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453(e,n,i){i.d(n,{R:()=>r,x:()=>l});var t=i(6540);const s={},o=t.createContext(s);function r(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);